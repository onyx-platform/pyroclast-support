<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.5">
<title>Pyroclast</title>
<style>
/*! normalize.css v2.1.2 | MIT License | git.io/normalize */
/* ========================================================================== HTML5 display definitions ========================================================================== */
/** Correct `block` display not defined in IE 8/9. */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }

/** Correct `inline-block` display not defined in IE 8/9. */
audio, canvas, video { display: inline-block; }

/** Prevent modern browsers from displaying `audio` without controls. Remove excess height in iOS 5 devices. */
audio:not([controls]) { display: none; height: 0; }

/** Address `[hidden]` styling not present in IE 8/9. Hide the `template` element in IE, Safari, and Firefox < 22. */
[hidden], template { display: none; }

script { display: none !important; }

/* ========================================================================== Base ========================================================================== */
/** 1. Set default font family to sans-serif. 2. Prevent iOS text size adjust after orientation change, without disabling user zoom. */
html { font-family: sans-serif; /* 1 */ -ms-text-size-adjust: 100%; /* 2 */ -webkit-text-size-adjust: 100%; /* 2 */ }

/** Remove default margin. */
body { margin: 0; }

/* ========================================================================== Links ========================================================================== */
/** Remove the gray background color from active links in IE 10. */
a { background: transparent; }

/** Address `outline` inconsistency between Chrome and other browsers. */
a:focus { outline: thin dotted; }

/** Improve readability when focused and also mouse hovered in all browsers. */
a:active, a:hover { outline: 0; }

/* ========================================================================== Typography ========================================================================== */
/** Address variable `h1` font-size and margin within `section` and `article` contexts in Firefox 4+, Safari 5, and Chrome. */
h1 { font-size: 2em; margin: 0.67em 0; }

/** Address styling not present in IE 8/9, Safari 5, and Chrome. */
abbr[title] { border-bottom: 1px dotted; }

/** Address style set to `bolder` in Firefox 4+, Safari 5, and Chrome. */
b, strong { font-weight: bold; }

/** Address styling not present in Safari 5 and Chrome. */
dfn { font-style: italic; }

/** Address differences between Firefox and other browsers. */
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }

/** Address styling not present in IE 8/9. */
mark { background: #ff0; color: #000; }

/** Correct font family set oddly in Safari 5 and Chrome. */
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }

/** Improve readability of pre-formatted text in all browsers. */
pre { white-space: pre-wrap; }

/** Set consistent quote types. */
q { quotes: "\201C" "\201D" "\2018" "\2019"; }

/** Address inconsistent and variable font size in all browsers. */
small { font-size: 80%; }

/** Prevent `sub` and `sup` affecting `line-height` in all browsers. */
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }

sup { top: -0.5em; }

sub { bottom: -0.25em; }

/* ========================================================================== Embedded content ========================================================================== */
/** Remove border when inside `a` element in IE 8/9. */
img { border: 0; }

/** Correct overflow displayed oddly in IE 9. */
svg:not(:root) { overflow: hidden; }

/* ========================================================================== Figures ========================================================================== */
/** Address margin not present in IE 8/9 and Safari 5. */
figure { margin: 0; }

/* ========================================================================== Forms ========================================================================== */
/** Define consistent border, margin, and padding. */
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }

/** 1. Correct `color` not being inherited in IE 8/9. 2. Remove padding so people aren't caught out if they zero out fieldsets. */
legend { border: 0; /* 1 */ padding: 0; /* 2 */ }

/** 1. Correct font family not being inherited in all browsers. 2. Correct font size not being inherited in all browsers. 3. Address margins set differently in Firefox 4+, Safari 5, and Chrome. */
button, input, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 2 */ margin: 0; /* 3 */ }

/** Address Firefox 4+ setting `line-height` on `input` using `!important` in the UA stylesheet. */
button, input { line-height: normal; }

/** Address inconsistent `text-transform` inheritance for `button` and `select`. All other form control elements do not inherit `text-transform` values. Correct `button` style inheritance in Chrome, Safari 5+, and IE 8+. Correct `select` style inheritance in Firefox 4+ and Opera. */
button, select { text-transform: none; }

/** 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio` and `video` controls. 2. Correct inability to style clickable `input` types in iOS. 3. Improve usability and consistency of cursor style between image-type `input` and others. */
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; /* 2 */ cursor: pointer; /* 3 */ }

/** Re-set default cursor for disabled elements. */
button[disabled], html input[disabled] { cursor: default; }

/** 1. Address box sizing set to `content-box` in IE 8/9. 2. Remove excess padding in IE 8/9. */
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; /* 1 */ padding: 0; /* 2 */ }

/** 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome. 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome (include `-moz` to future-proof). */
input[type="search"] { -webkit-appearance: textfield; /* 1 */ -moz-box-sizing: content-box; -webkit-box-sizing: content-box; /* 2 */ box-sizing: content-box; }

/** Remove inner padding and search cancel button in Safari 5 and Chrome on OS X. */
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }

/** Remove inner padding and border in Firefox 4+. */
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }

/** 1. Remove default vertical scrollbar in IE 8/9. 2. Improve readability and alignment in all browsers. */
textarea { overflow: auto; /* 1 */ vertical-align: top; /* 2 */ }

/* ========================================================================== Tables ========================================================================== */
/** Remove most spacing between table cells. */
table { border-collapse: collapse; border-spacing: 0; }

meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }

meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }

meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }

*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }

html, body { font-size: 100%; }

body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }

a:hover { cursor: pointer; }

img, object, embed { max-width: 100%; height: auto; }

object, embed { height: 100%; }

img { -ms-interpolation-mode: bicubic; }

#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }

.left { float: left !important; }

.right { float: right !important; }

.text-left { text-align: left !important; }

.text-right { text-align: right !important; }

.text-center { text-align: center !important; }

.text-justify { text-align: justify !important; }

.hide { display: none; }

.antialiased, body { -webkit-font-smoothing: antialiased; }

img { display: inline-block; vertical-align: middle; }

textarea { height: auto; min-height: 50px; }

select { width: 100%; }

object, svg { display: inline-block; vertical-align: middle; }

.center { margin-left: auto; margin-right: auto; }

.spread { width: 100%; }

p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }

.subheader, .admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { line-height: 1.4; color: #003b6b; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }

/* Typography resets */
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }

/* Default Link Styles */
a { color: #00579e; text-decoration: none; line-height: inherit; }
a:hover, a:focus { color: #333333; }
a img { border: none; }

/* Default paragraph styles */
p { font-family: Arial, sans-serif; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }

/* Default header styles */
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Arial, sans-serif; font-weight: normal; font-style: normal; color: #7b2d00; text-rendering: optimizeLegibility; margin-top: 0.5em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #ff6b15; line-height: 0; }

h1 { font-size: 2.125em; }

h2 { font-size: 1.6875em; }

h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }

h4 { font-size: 1.125em; }

h5 { font-size: 1.125em; }

h6 { font-size: 1em; }

hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }

/* Helpful Typography Defaults */
em, i { font-style: italic; line-height: inherit; }

strong, b { font-weight: bold; line-height: inherit; }

small { font-size: 60%; line-height: inherit; }

code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: bold; color: #003426; }

/* Lists */
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 0.75em; list-style-position: outside; font-family: Arial, sans-serif; }

ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }

/* Unordered Lists */
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; /* Override nested font-size change */ }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }

/* Ordered Lists */
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }

/* Definition Lists */
dl dt { margin-bottom: 0.3em; font-weight: bold; }
dl dd { margin-bottom: 0.75em; }

/* Abbreviations */
abbr, acronym { text-transform: uppercase; font-size: 90%; color: black; border-bottom: 1px dotted #dddddd; cursor: help; }

abbr { text-transform: none; }

/* Blockquotes */
blockquote { margin: 0 0 0.75em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: 0.8125em; color: #e15200; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #e15200; }

blockquote, blockquote p { line-height: 1.6; color: #333333; }

/* Microformats */
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }

.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }

@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
/* Tables */
table { background: white; margin-bottom: 1.25em; border: solid 1px #d8d8ce; }
table thead, table tfoot { background: -webkit-linear-gradient(top, #add386, #90b66a); font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: white; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #6d6e71; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #edf2f2; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.4; }

body { tab-size: 4; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }

a:hover, a:focus { text-decoration: underline; }

.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }

*:not(pre) > code { font-size: inherit; font-style: normal !important; letter-spacing: 0; padding: 3px 2px 1px 2px; background-color: #eeeeee; border: 1px solid #dddddd; -webkit-border-radius: 0; border-radius: 0; line-height: inherit; }

pre, pre > code { line-height: 1.6; color: black; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }

.keyseq { color: #333333; }

kbd { font-family: Consolas, "Liberation Mono", Courier, monospace; display: inline-block; color: black; font-size: 0.65em; line-height: 1.45; background-color: #f7f7f7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 0.1em white inset; margin: 0 0.15em; padding: 0.2em 0.5em; vertical-align: middle; position: relative; top: -0.1em; white-space: nowrap; }

.keyseq kbd:first-child { margin-left: 0; }

.keyseq kbd:last-child { margin-right: 0; }

.menuseq, .menu { color: black; }

b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }

b.button:before { content: "["; padding: 0 3px 0 2px; }

b.button:after { content: "]"; padding: 0 2px 0 3px; }

#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 1.5em; padding-right: 1.5em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }

#content { margin-top: 1.25em; }

#content:before { content: none; }

#header > h1:first-child { color: #7b2d00; margin-top: 2.25rem; margin-bottom: 0; }
#header > h1:first-child + #toc { margin-top: 8px; border-top: 1px solid #dddddd; }
#header > h1:only-child, body.toc2 #header > h1:nth-last-child(2) { border-bottom: 1px solid #dddddd; padding-bottom: 8px; }
#header .details { border-bottom: 1px solid #dddddd; line-height: 1.45; padding-top: 0.25em; padding-bottom: 0.25em; padding-left: 0.25em; color: #e15200; display: -ms-flexbox; display: -webkit-flex; display: flex; -ms-flex-flow: row wrap; -webkit-flex-flow: row wrap; flex-flow: row wrap; }
#header .details span:first-child { margin-left: -0.125em; }
#header .details span.email a { color: #333333; }
#header .details br { display: none; }
#header .details br + span:before { content: "\00a0\2013\00a0"; }
#header .details br + span.author:before { content: "\00a0\22c5\00a0"; color: #333333; }
#header .details br + span#revremark:before { content: "\00a0|\00a0"; }
#header #revnumber { text-transform: capitalize; }
#header #revnumber:after { content: "\00a0"; }

#content > h1:first-child:not([class]) { color: #7b2d00; border-bottom: 1px solid #dddddd; padding-bottom: 8px; margin-top: 0; padding-top: 1rem; margin-bottom: 1.25rem; }

#toc { border-bottom: 0 solid #dddddd; padding-bottom: 0.5em; }
#toc > ul { margin-left: 0.125em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin: 0.5em 0; }
#toc ul { font-family: Arial, sans-serif; list-style-type: none; }
#toc li { line-height: 1.3334; margin-top: 0.3334em; }
#toc a { text-decoration: none; }
#toc a:active { text-decoration: underline; }

#toctitle { color: #003b6b; font-size: 1.2em; }

@media only screen and (min-width: 768px) { #toctitle { font-size: 1.375em; }
  body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { margin-top: 0 !important; background-color: white; position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #dddddd; border-top-width: 0 !important; border-bottom-width: 0 !important; z-index: 1000; padding: 1.25em 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; margin-bottom: 0.8rem; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: 0.9em; margin-bottom: 0; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right-width: 0; border-left: 1px solid #dddddd; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }

#footer { max-width: 100%; background-color: none; padding: 1.25em; }

#footer-text { color: black; line-height: 1.44; }

.sect1 { padding-bottom: 0.625em; }

@media only screen and (min-width: 768px) { .sect1 { padding-bottom: 1.25em; } }
.sect1 + .sect1 { border-top: 0 solid #dddddd; }

#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; z-index: 1001; width: 1.5ex; margin-left: -1.5ex; display: block; text-decoration: none !important; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: "\00A7"; font-size: 0.85em; display: block; padding-top: 0.1em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #7b2d00; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #622400; }

.audioblock, .imageblock, .literalblock, .listingblock, .stemblock, .videoblock { margin-bottom: 1.25em; }

.admonitionblock td.content > .title, .audioblock > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .stemblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, table.tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-rendering: optimizeLegibility; text-align: left; }

table.tableblock > caption.title { white-space: nowrap; overflow: visible; max-width: 0; }

.paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { color: #7b2d00; }

table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }

.admonitionblock > table { border-collapse: separate; border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; font-family: Arial, sans-serif; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #e15200; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }

.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }

.sidebarblock { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 0; border-radius: 0; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock > .content > .title { color: #003b6b; margin-top: 0; }

.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }

.literalblock pre, .listingblock pre:not(.highlight), .listingblock pre[class="highlight"], .listingblock pre[class^="highlight "], .listingblock pre.CodeRay, .listingblock pre.prettyprint { background: #eeeeee; }
.sidebarblock .literalblock pre, .sidebarblock .listingblock pre:not(.highlight), .sidebarblock .listingblock pre[class="highlight"], .sidebarblock .listingblock pre[class^="highlight "], .sidebarblock .listingblock pre.CodeRay, .sidebarblock .listingblock pre.prettyprint { background: #f2f1f1; }

.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border: 1px dashed #666666; -webkit-border-radius: 0; border-radius: 0; word-wrap: break-word; padding: 1.25em 1.5625em 1.125em 1.5625em; font-size: 0.8125em; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.90625em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }

.literalblock.output pre { color: #eeeeee; background-color: black; }

.listingblock pre.highlightjs { padding: 0; }
.listingblock pre.highlightjs > code { padding: 1.25em 1.5625em 1.125em 1.5625em; -webkit-border-radius: 0; border-radius: 0; }

.listingblock > .content { position: relative; }

.listingblock code[data-lang]:before { display: none; content: attr(data-lang); position: absolute; font-size: 0.75em; top: 0.425rem; right: 0.5rem; line-height: 1; text-transform: uppercase; color: #999; }

.listingblock:hover code[data-lang]:before { display: block; }

.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }

.listingblock.terminal pre .command:not([data-prompt]):before { content: "$"; }

table.pyhltable { border-collapse: separate; border: 0; margin-bottom: 0; background: none; }

table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; line-height: 1.6; }

table.pyhltable td.code { padding-left: .75em; padding-right: 0; }

pre.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }

pre.pygments .lineno { display: inline-block; margin-right: .25em; }

table.pyhltable .linenodiv { background: none !important; padding-right: 0 !important; }

.quoteblock { margin: 0 1em 0.75em 1.5em; display: table; }
.quoteblock > .title { margin-left: -1.5em; margin-bottom: 0.75em; }
.quoteblock blockquote, .quoteblock blockquote p { color: #333333; font-size: 1.15rem; line-height: 1.75; word-spacing: 0.1em; letter-spacing: 0; font-style: italic; text-align: justify; }
.quoteblock blockquote { margin: 0; padding: 0; border: 0; }
.quoteblock blockquote:before { content: "\201c"; float: left; font-size: 2.75em; font-weight: bold; line-height: 0.6em; margin-left: -0.6em; color: #003b6b; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: 0.5em; margin-right: 0.5ex; text-align: right; }
.quoteblock .quoteblock { margin-left: 0; margin-right: 0; padding: 0.5em 0; border-left: 3px solid #e15200; }
.quoteblock .quoteblock blockquote { padding: 0 0 0 0.75em; }
.quoteblock .quoteblock blockquote:before { display: none; }

.verseblock { margin: 0 1em 0.75em 1em; }
.verseblock pre { font-family: "Open Sans", "DejaVu Sans", sans; font-size: 1.15rem; color: #333333; font-weight: 300; text-rendering: optimizeLegibility; }
.verseblock pre strong { font-weight: 400; }
.verseblock .attribution { margin-top: 1.25rem; margin-left: 0.5ex; }

.quoteblock .attribution, .verseblock .attribution { font-size: 0.8125em; line-height: 1.45; font-style: italic; }
.quoteblock .attribution br, .verseblock .attribution br { display: none; }
.quoteblock .attribution cite, .verseblock .attribution cite { display: block; letter-spacing: -0.025em; color: #e15200; }

.quoteblock.abstract { margin: 0 0 0.75em 0; display: block; }
.quoteblock.abstract blockquote, .quoteblock.abstract blockquote p { text-align: left; word-spacing: 0; }
.quoteblock.abstract blockquote:before, .quoteblock.abstract blockquote p:first-of-type:before { display: none; }

table.tableblock { max-width: 100%; border-collapse: separate; }
table.tableblock td > .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }

table.tableblock, th.tableblock, td.tableblock { border: 0 solid #d8d8ce; }

table.grid-all th.tableblock, table.grid-all td.tableblock { border-width: 0 1px 1px 0; }

table.grid-all tfoot > tr > th.tableblock, table.grid-all tfoot > tr > td.tableblock { border-width: 1px 1px 0 0; }

table.grid-cols th.tableblock, table.grid-cols td.tableblock { border-width: 0 1px 0 0; }

table.grid-all * > tr > .tableblock:last-child, table.grid-cols * > tr > .tableblock:last-child { border-right-width: 0; }

table.grid-rows th.tableblock, table.grid-rows td.tableblock { border-width: 0 0 1px 0; }

table.grid-all tbody > tr:last-child > th.tableblock, table.grid-all tbody > tr:last-child > td.tableblock, table.grid-all thead:last-child > tr > th.tableblock, table.grid-rows tbody > tr:last-child > th.tableblock, table.grid-rows tbody > tr:last-child > td.tableblock, table.grid-rows thead:last-child > tr > th.tableblock { border-bottom-width: 0; }

table.grid-rows tfoot > tr > th.tableblock, table.grid-rows tfoot > tr > td.tableblock { border-width: 1px 0 0 0; }

table.frame-all { border-width: 1px; }

table.frame-sides { border-width: 0 1px; }

table.frame-topbot { border-width: 1px 0; }

th.halign-left, td.halign-left { text-align: left; }

th.halign-right, td.halign-right { text-align: right; }

th.halign-center, td.halign-center { text-align: center; }

th.valign-top, td.valign-top { vertical-align: top; }

th.valign-bottom, td.valign-bottom { vertical-align: bottom; }

th.valign-middle, td.valign-middle { vertical-align: middle; }

table thead th, table tfoot th { font-weight: bold; }

tbody tr th { display: table-cell; line-height: 1.4; background: -webkit-linear-gradient(top, #add386, #90b66a); }

tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: white; font-weight: bold; }

p.tableblock > code:only-child { background: none; padding: 0; }

p.tableblock { font-size: 1em; }

td > div.verse { white-space: pre; }

ol { margin-left: 1.75em; }

ul li ol { margin-left: 1.5em; }

dl dd { margin-left: 1.125em; }

dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }

ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.375em; }

ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }

ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }

ul.checklist li > p:first-child > .fa-square-o:first-child, ul.checklist li > p:first-child > .fa-check-square-o:first-child { width: 1em; font-size: 0.85em; }

ul.checklist li > p:first-child > input[type="checkbox"]:first-child { width: 1em; position: relative; top: 1px; }

ul.inline { margin: 0 auto 0.375em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }

.unstyled dl dt { font-weight: normal; font-style: normal; }

ol.arabic { list-style-type: decimal; }

ol.decimal { list-style-type: decimal-leading-zero; }

ol.loweralpha { list-style-type: lower-alpha; }

ol.upperalpha { list-style-type: upper-alpha; }

ol.lowerroman { list-style-type: lower-roman; }

ol.upperroman { list-style-type: upper-roman; }

ol.lowergreek { list-style-type: lower-greek; }

.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }

td.hdlist1, td.hdlist2 { vertical-align: top; padding: 0 0.625em; }

td.hdlist1 { font-weight: bold; padding-bottom: 0.75em; }

.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }

.colist > table tr > td:first-of-type { padding: 0 0.75em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }

.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }

.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }

.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }

a.image { text-decoration: none; display: inline-block; }
a.image object { pointer-events: none; }

sup.footnote, sup.footnoteref { font-size: 0.875em; position: static; vertical-align: super; }
sup.footnote a, sup.footnoteref a { text-decoration: none; }
sup.footnote a:active, sup.footnoteref a:active { text-decoration: underline; }

#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -0.25em 0 0.75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em 0 0.225em; line-height: 1.3334; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.05em; margin-bottom: 0.2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }

.gist .file-data > table { border: 0; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }

div.unbreakable { page-break-inside: avoid; }

.big { font-size: larger; }

.small { font-size: smaller; }

.underline { text-decoration: underline; }

.overline { text-decoration: overline; }

.line-through { text-decoration: line-through; }

.aqua { color: #00bfbf; }

.aqua-background { background-color: #00fafa; }

.black { color: black; }

.black-background { background-color: black; }

.blue { color: #0000bf; }

.blue-background { background-color: #0000fa; }

.fuchsia { color: #bf00bf; }

.fuchsia-background { background-color: #fa00fa; }

.gray { color: #606060; }

.gray-background { background-color: #7d7d7d; }

.green { color: #006000; }

.green-background { background-color: #007d00; }

.lime { color: #00bf00; }

.lime-background { background-color: #00fa00; }

.maroon { color: #600000; }

.maroon-background { background-color: #7d0000; }

.navy { color: #000060; }

.navy-background { background-color: #00007d; }

.olive { color: #606000; }

.olive-background { background-color: #7d7d00; }

.purple { color: #600060; }

.purple-background { background-color: #7d007d; }

.red { color: #bf0000; }

.red-background { background-color: #fa0000; }

.silver { color: #909090; }

.silver-background { background-color: #bcbcbc; }

.teal { color: #006060; }

.teal-background { background-color: #007d7d; }

.white { color: #bfbfbf; }

.white-background { background-color: #fafafa; }

.yellow { color: #bfbf00; }

.yellow-background { background-color: #fafa00; }

span.icon > .fa { cursor: default; }

.admonitionblock td.icon [class^="fa icon-"] { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #004176; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }

.conum[data-value] { display: inline-block; color: #fff !important; background-color: black; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; font-size: 0.75em; width: 1.67em; height: 1.67em; line-height: 1.67em; font-family: "Open Sans", "DejaVu Sans", sans-serif; font-style: normal; font-weight: bold; }
.conum[data-value] * { color: #fff !important; }
.conum[data-value] + b { display: none; }
.conum[data-value]:after { content: attr(data-value); }
pre .conum[data-value] { position: relative; top: -0.125em; }

b.conum * { color: inherit !important; }

.conum:not([data-value]):empty { display: none; }

h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { border-bottom: 1px solid #dddddd; }

.sect1 { padding-bottom: 0; }

#toctitle { color: #00406F; font-weight: normal; margin-top: 1.5em; }

.sidebarblock { border-color: #aaa; }

code { -webkit-border-radius: 4px; border-radius: 4px; }

p.tableblock.header { color: #6d6e71; }

.literalblock pre, .listingblock pre { background: #eeeeee; }

</style>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Pyroclast</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_overview">Overview</a>
<ul class="sectlevel2">
<li><a href="#_store">Store</a></li>
<li><a href="#_compute">Compute</a></li>
<li><a href="#_query">Query</a></li>
<li><a href="#_topics">Topics</a></li>
<li><a href="#_services">Services</a></li>
<li><a href="#_deployments_2">Deployments</a></li>
</ul>
</li>
<li><a href="#_ingesting_events_into_pyroclast">Ingesting Events into Pyroclast</a>
<ul class="sectlevel2">
<li><a href="#_https">HTTPS</a></li>
<li><a href="#_plumes">Plumes</a></li>
</ul>
</li>
<li><a href="#_how_pyroclast_works">How Pyroclast Works</a>
<ul class="sectlevel2">
<li><a href="#_high_level_summary">High Level Summary</a></li>
<li><a href="#_topics_2">Topics</a></li>
<li><a href="#_services_2">Services</a></li>
</ul>
</li>
<li><a href="#_pyroclast_api">Pyroclast API</a>
<ul class="sectlevel2">
<li><a href="#_get_svc_service_id">GET /svc/:service-id</a></li>
<li><a href="#_get_svc_service_id_aggregate">GET /svc/:service-id/:aggregate</a></li>
<li><a href="#_get_svc_aggregate_group">GET /svc/:aggregate/:group</a></li>
</ul>
</li>
<li><a href="#_usage_patterns">Usage Patterns</a>
<ul class="sectlevel2">
<li><a href="#_parsing_value_types">Parsing value types</a></li>
<li><a href="#_selecting_relevant_events">Selecting relevant events</a></li>
<li><a href="#_diangosing_unconforming_data">Diangosing unconforming data</a></li>
<li><a href="#_changing_event_structure">Changing Event Structure</a></li>
<li><a href="#_splitting_a_single_record_into_many_records">Splitting a single record into many records</a></li>
<li><a href="#_parsing_regular_expressions_into_named_values">Parsing regular expressions into named values</a></li>
<li><a href="#_assigning_default_values">Assigning default values</a></li>
<li><a href="#_coercing_datetime_values">Coercing datetime values</a></li>
<li><a href="#_accessing_nested_values">Accessing nested values</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<!-- toc disabled -->
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Pyroclast is a cloud-hosted platform for building realtime data applications. We make Streaming as a Service easy:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>You</strong>: send events to Pyroclast via HTTP or our data extraction tools</p>
</li>
<li>
<p><strong>We</strong>: receive your events and place them into our hosted storage</p>
</li>
<li>
<p><strong>You</strong>: define service specifications to transform, filter, and aggregate your events</p>
</li>
<li>
<p><strong>We</strong>: run your services in a high speed, scalable, fault tolerant environment</p>
</li>
<li>
<p><strong>We</strong>: maintain and serve materialized views of your events through service HTTP endpoints</p>
</li>
<li>
<p><strong>You</strong>: build applications against those HTTP endpoints</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Pyroclast gives you three dimensions for working with your event data: store, compute, and query. Leveraging each of these allows your architecture to treat Pyroclast as a service.</p>
</div>
<div class="sect2">
<h3 id="_store"><a class="anchor" href="#_store"></a>Store</h3>
<div class="paragraph">
<p>When event data is published to Pyroclast, you specify a "topic" that it routes to. A topic is a named stream of events, often representation of a feed or a category. Event data is "pushed" into Pyroclast via HTTP or tools that send data directly to our storage. This is different from Pyroclast periodically "pulling" your data. We only receive data that you directly send to us.</p>
</div>
<div class="paragraph">
<p>When you create a topic, you specify how long Pyroclast should retain your events for. You choose both a duration in number of days and a limit number of gigabytes. After your events either become older than the number of specified days, or you send Pyroclast more bytes than the limit chosen, they will be discarded. We currently allow you to set very high retention limits for both duration and number of gigabytes, and will also soon be offering an archival policy to store your data in a predetermined location after it is discarded from Pyroclast.</p>
</div>
</div>
<div class="sect2">
<h3 id="_compute"><a class="anchor" href="#_compute"></a>Compute</h3>
<div class="paragraph">
<p>Once you&#8217;ve decided on what sort of data will go inside your topics, you build web service specifications to change your event data in some way. Services consist of a series of transformations, filters, and aggregates to reshape your data into a form that you find most beneficial for analysis. A topic can have any number of services reading and processing from it without conflict. Two or more services that read from the same topic will receive the same series of events. This lets you build different applications over the same data stream without needing to copy events or negotiation data formats.</p>
</div>
<div class="paragraph">
<p>Services are constructed in the browser using a feature-rich editor. Pyroclast offers a very large set of transformations, filters, and aggregates out of the box to perform common data manipulation. You can also write JavaScript to be directly executed when we don&#8217;t have a function that you&#8217;re looking for.</p>
</div>
<div class="paragraph">
<p>Services are interactively developed in the browser alongside a feature named the Simulator. The simulator accepts sample data that represents events on your topic and displays how your data will change as it flows through your service. The simulator is extraordinarily responsive. Each key stroke and mouse click will instantaneously update the view of how your data changes. The simulator let&#8217;s you experiment, iterate, detect, and correct mistakes as soon as they&#8217;re made for maximum productivity.</p>
</div>
<div class="paragraph">
<p>When you&#8217;re happy with your service, you launch it onto our infrastructure with the click on a button. Pyroclast start pulling data from your topics and processing it in the fashion that you&#8217;ve chosen. Pyroclast&#8217;s computation layer is extremely fast and can handle very high volumes of data. It&#8217;s able to recover in a safe manner in the event of an internal or external failure.</p>
</div>
</div>
<div class="sect2">
<h3 id="_query"><a class="anchor" href="#_query"></a>Query</h3>
<div class="paragraph">
<p>When your service is up and running, you&#8217;re able to ask questions about your event data as it flows through Pyroclast. For each aggregate that you create in your service, Pyroclast exposes an HTTP endpoint. This endpoint returns a materialized view of your event data that&#8217;s being updated in real time. You use these endpoints to serve realtime data as if it were coming out of your own application. Pyroclast can be treated as a plain service, just like any other service you would design for your architecture.</p>
</div>
<div class="paragraph">
<p>Pyroclast exposes a highly flexible windowing abstraction to slice your data into a time series. If your event data is timestamped, you can segment it by the moment at which it occurred - not by the moment at which it was received by Pyroclast. This is a powerful building block because you can backfill historical data into Pyroclast and analyze it separately. Using this technique means that you don&#8217;t need to worry about polluting current data with older data.
== Concepts</p>
</div>
</div>
<div class="sect2">
<h3 id="_topics"><a class="anchor" href="#_topics"></a>Topics</h3>
<div class="paragraph">
<p>A topic is a named stream of events, typically representative of a feed or a category of information.
Each topic is a unit of storage where Pyroclast initially receives your data. When your data enters
a topic, it is durably stored and replicated for a specified amount of time. Topics have been designed
to have several characteristics that make the highly suitable to event stream processing. We&#8217;ll go through
each of these in turn.</p>
</div>
<div class="sect3">
<h4 id="_immutability"><a class="anchor" href="#_immutability"></a>Immutability</h4>
<div class="paragraph">
<p>Once an event be written to a topic, it cannot be deleted unless the entire topic is deleted. This is called
immutability. The topic can only be modified by appending more events to its tail. An event represents a fact
of information about something that occurred. Facts are true as of a particular point in time, and cannot be modified
or erased from history. This mode of thinking enables rich analysis of historical information, and maximizes
knowledge about the present by retaining as much data about the past as possible.</p>
</div>
</div>
<div class="sect3">
<h4 id="_retention"><a class="anchor" href="#_retention"></a>Retention</h4>
<div class="paragraph">
<p>Events are stored in a topic for a specified duration - both in terms of number of gigabytes and number of days.
While the events in a topic are immutable, they will be deleted when they go beyond their retention policy. This
is a matter of practicability. Information about the past is typically only useful within a certain bound of time.
For example, if the retention policy for a topic is to store events for no more than 10 days or 50 gigabytes, events
that are either more than 10 days old, <strong>or</strong> events that are not within the most recent 50 gigabytes received will
be deleted.</p>
</div>
<div class="paragraph">
<p>Once a topic has been created and its retention policy specified, it cannot be modified.</p>
</div>
<div class="paragraph">
<p>Retention policies are not hard guarantees. Events may be available for processing even if they are beyond their
retention limits. This behavior should not be relied upon.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ingesting"><a class="anchor" href="#_ingesting"></a>Ingesting</h4>
<div class="paragraph">
<p>Events are sent to a particular topic via push-based tooling. Pyroclast currently offers an HTTP based method of
writing data to a topic, or using Plumes. See the guide on Ingesting events for more information.</p>
</div>
</div>
<div class="sect3">
<h4 id="_sharability"><a class="anchor" href="#_sharability"></a>Sharability</h4>
<div class="paragraph">
<p>Topics are different from traditional databases in that sharing their contents to different consumers is completely safe.</p>
</div>
<div class="paragraph">
<p>When considering which topic an event should be written to, it might be tempting to write it to multiple topics and
to design a service per topic to each perform a different task. This is an anti-pattern that is discouraged in Pyroclast.
Instead, write each event to exactly one topic and design several services that each consume from the same topic.
Since topics are immutable, there is no penalty to sharing topics across as many services as you&#8217;d like. Fewer topics
also means fewer sources of data to manage.</p>
</div>
</div>
<div class="sect3">
<h4 id="_replay"><a class="anchor" href="#_replay"></a>Replay</h4>
<div class="paragraph">
<p>The central idea behind Pyroclast is that you author services which read events from a topic and materialize a view
of those events, which is consumed from an HTTP API. Since topics are fully immutable, and thus can be shared, topics
may also be <strong>replayed</strong> by a service. We say that a service <strong>replays</strong> a topic when that service is started, reads same
data from the topic, is stopped, and then started again. When you restart a service, you can specify where
to in the topic events should start to be read from. You can either <strong>resume</strong> from the point in the topic where the
service previously left off, or you can <strong>replay</strong> the topic from the beginning (or any arbitrary point time, for that matter).</p>
</div>
<div class="paragraph">
<p>This ability is incredibly useful for repairing services that had a bug, or a change in requirements. A brand new view
of events can be materialized without disrupting the contents of the topic.</p>
</div>
</div>
<div class="sect3">
<h4 id="_schema"><a class="anchor" href="#_schema"></a>Schema</h4>
<div class="paragraph">
<p>Events that are written to a topic ought to follow a particular schema. Currently, Pyroclast only supports events ingested
in the form of JSON maps. We will extend this in the future to cover more formats.</p>
</div>
<div class="paragraph">
<p>Pyroclast currently does not support a mechanism to enforce a user defined schema to block malformed data from being written
to a topic. This will be added in the near future, but for the moment it is up to the producers of events to ensure that
the contents of their payloads conforms to their needs.</p>
</div>
</div>
<div class="sect3">
<h4 id="_chaining"><a class="anchor" href="#_chaining"></a>Chaining</h4>
<div class="paragraph">
<p>Just as you can write information to a topic using HTTP or Plumes, services which read information from a topic can transform
events and write them back to a topic. Such types of services are loosely named "data pipelines". They&#8217;re given their name
because they route events through a sequence of operations and out the other end to a new topic, similar to water flowing
through a pipe. This is most typically used by having one main topic for ingestion, and several other "derived" topics which
contain events that have been transformed from the initial topic. This encourages you to write small, focused services, and thus
gain reusability.</p>
</div>
<div class="paragraph">
<p>It is possible to create a service that reads from a topic and writes back to the same topic, creating a cycle.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_services"><a class="anchor" href="#_services"></a>Services</h3>
<div class="paragraph">
<p>The means by which you act on events stored in a topic is a service. A service is specification of how
to reshape events from a topic, and an instance of that service running is named a deployment.</p>
</div>
<div class="sect3">
<h4 id="_templates"><a class="anchor" href="#_templates"></a>Templates</h4>
<div class="paragraph">
<p>When a service is created, it needs to be given a name so that we can refer back to it over time.
A service also needs to be created from a <strong>template</strong>. Templates are light-weight suggestions on
how to structure the sequence of steps that a service will employ to reshape your events. Templates
simply set up a few example steps to get you going. A template doesn&#8217;t lock you into a particular kind
of service. You can change every aspect of how your service functions after its been created. We&#8217;ll explore
the different templates and their motivations later in this section.</p>
</div>
</div>
<div class="sect3">
<h4 id="_service_specification"><a class="anchor" href="#_service_specification"></a>Service Specification</h4>
<div class="paragraph">
<p>Designing a service involves creating a sequence of steps to be applied to events being read from a topic
and choosing what to do with the result of those steps being applied. A service that reads from a topic
can apply three different functions to the events it receives: transform, filter, and aggregate.</p>
</div>
<div class="sect4">
<h5 id="_transform"><a class="anchor" href="#_transform"></a>Transform</h5>
<div class="paragraph">
<p>A transformation function takes an event, updates it in some way, and returns that same event. An example
of a transformation function is the Capitalize function. This function takes a key in an event which
has the value of a string, and returns that same event with the specified key&#8217;s value changed into a
capitalized form. This is a 1-1 mapping between input and output.</p>
</div>
</div>
<div class="sect4">
<h5 id="_filter"><a class="anchor" href="#_filter"></a>Filter</h5>
<div class="paragraph">
<p>A filter function takes an event and applies a predicate function to it. If the predicate evaluates to true,
the event proceeds to the next step in the service. If the predicate evaluates to false, it is discarded.
This is useful for extracting a particular selection of events in a topic that a service is interested in.
Filter functions that one event, and either return that event, or no events.</p>
</div>
<div class="paragraph">
<p>Filter predicates can be negated, allowing only events that return a false predicate. Predicates can optionally
throw an exception they fail to match on an event. This is useful when filters are being used as a sanity check, or
a mechanism to detect malformed events. In those cases, it&#8217;s useful not only to not process those events, but to also
throw an exception, which will in turn display the contents of the event that failed. In this way, filters can
act as a debugger.</p>
</div>
</div>
<div class="sect4">
<h5 id="_aggregate"><a class="anchor" href="#_aggregate"></a>Aggregate</h5>
<div class="paragraph">
<p>An aggregate function reduces a sequence of events into a smaller value representative of the entire topic.
Aggregates, like sum, min, max, and so forth, are rolling computations whose value updates as more events
are processed from a topic. Aggregates automatically roll up sequence of events for you from a topic, and do
not operate on a single key within each event. Aggregates are specified by windowing type. A global window
aggregates all events in a topic, irrespective of their timestamps. Other window types (fixed, sliding, and session)
taken into account a timestamp associated with each event to shard aggregations over particular intervals of time.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constraints"><a class="anchor" href="#_constraints"></a>Constraints</h4>
<div class="paragraph">
<p>The sequence of steps in a service specification is constrained in a few ways to maximize productivity.</p>
</div>
<div class="sect4">
<h5 id="_linear_sequences_only"><a class="anchor" href="#_linear_sequences_only"></a>Linear Sequences Only</h5>
<div class="paragraph">
<p>The sequence of steps in a service is linear. That is, the steps may not "branch" and "reconverge".
If branching is needed, it&#8217;s encouraged to write another service over the same topic.</p>
</div>
</div>
<div class="sect4">
<h5 id="_one_input_topic"><a class="anchor" href="#_one_input_topic"></a>One Input Topic</h5>
<div class="paragraph">
<p>Each service can only read events from one input topic. Each event ought to only exist in one ingested
topic, so this constraint discourages the multi-topic anti-pattern discussed in the topics section.</p>
</div>
</div>
<div class="sect4">
<h5 id="_final_step"><a class="anchor" href="#_final_step"></a>Final Step</h5>
<div class="paragraph">
<p>The final step of a service must either be an aggregate or an output to another topic. The resulting
events need to be stored somewhere, meaning that it doesn&#8217;t make sense for the last step in an service
to be either a transformation function or a filter.</p>
</div>
</div>
<div class="sect4">
<h5 id="_one_aggregate"><a class="anchor" href="#_one_aggregate"></a>One Aggregate</h5>
<div class="paragraph">
<p>A service may only have one aggregate in its sequence of steps. This is a limitation that will be removed
in the future, but is important to note for now.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_deployments"><a class="anchor" href="#_deployments"></a>Deployments</h4>
<div class="paragraph">
<p>If service is a specification for the sequence of steps to transform data, we need some way to instantiate
that service into a running entity. We call the realization of a service a <strong>deployment</strong>. Each service
may be deployed zero or more times. When a service is created, Pyroclast automatically creates three deployments
for you: development, test, and production. Deployments can be given any name you wish, and you can create
or delete deployments for a service. All newly created deployments start with the status <strong>disabled</strong>. You can <strong>activate</strong>
the deployment when you&#8217;re ready to begin processing data with it, and <strong>stop</strong> it at any stop.</p>
</div>
</div>
<div class="sect3">
<h4 id="_service_types"><a class="anchor" href="#_service_types"></a>Service Types</h4>
<div class="paragraph">
<p>When a service is created, a template for that service is chosen. There are four different kinds of services:
data pipeline, materialized view, metrics, and manifest file. We&#8217;ll look at each.</p>
</div>
<div class="sect4">
<h5 id="_data_pipeline"><a class="anchor" href="#_data_pipeline"></a>Data pipeline</h5>
<div class="paragraph">
<p>A data pipeline is a loose term for a service that reads events from a topic and writes its output events to another
topic. When the template for this is chosen, the editor automatically sets up the sequence of steps to terminate
in an output step.</p>
</div>
</div>
<div class="sect4">
<h5 id="_materialized_view"><a class="anchor" href="#_materialized_view"></a>Materialized View</h5>
<div class="paragraph">
<p>A materialized view is a data structure that represents an aggregate of your data. This is the value that is accessed
via an HTTP endpoint when a deployment has begun running, allowing you to extract information from your event stream
out of Pyroclast. When this template is chosen, the editor automatically adds a final step to terminate in an aggregate,</p>
</div>
</div>
<div class="sect4">
<h5 id="_metrics"><a class="anchor" href="#_metrics"></a>Metrics</h5>
<div class="paragraph">
<p>A metrics service operates on <strong>metadata</strong> of events from a designated input topic. When this template is chosen, the input
task step has the "Meta topic?" checkbox automatically selected. When this service is deployed, instead of receiving a
sequence of events, the service instead receives a <strong>meta-event</strong>. The event is a map with keys that represent the number
of bytes in the ingested record, a timestamp when Pyroclast received the record, and the record itself. This is useful
for writing auditing services that produce time-delineated aggregates of how much data was received when for particular attributes.</p>
</div>
</div>
<div class="sect4">
<h5 id="_manifest_file"><a class="anchor" href="#_manifest_file"></a>Manifest File</h5>
<div class="paragraph">
<p>The manifest option isn&#8217;t a particular "kind" of service per say. When a service is created, a manifest of its specification can
be downloaded as a text file. Choosing the manifest file option will open a file picker, and the downloaded file from another service
can be chosen and uploaded. When chosen, an exact copy of that service will be installed into your account (excluding any deployments).
This is useful for sharing services.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deployments_2"><a class="anchor" href="#_deployments_2"></a>Deployments</h3>
<div class="paragraph">
<p>The running instantiation of a service is called a deployment. Deployments actively process
events from a topic and update aggregates, which may be queried from HTTP endpoints. Deployments
run in a fully-hosted setting in Pyroclast&#8217;s cloud.</p>
</div>
<div class="sect3">
<h4 id="_activating_upgrading"><a class="anchor" href="#_activating_upgrading"></a>Activating / Upgrading</h4>
<div class="paragraph">
<p>After designing a service, the next thing you&#8217;ll want to do is launch it. Choose "Commit" in the
upper right hand corner of the editing screen, then click on the Deployments bar the bottom oft
the screen. This will drop up a list of deployments that can be activate or upgrade. Before a deployment
can take place, the service must be committed, and must be in a valid state. If the service is invalid
or it&#8217;s not been committed, the buttons will be disabled.</p>
</div>
<div class="paragraph">
<p>Choose "activate" (if this is the first time this deployment will run) or "upgrade" (available if this
deployment had already been started). A modal will pop up confirming that you are clear for launch. You
may either <strong>rebuild</strong> state, or <strong>resume</strong> from the last place this deployment left off - depending on the circumstances.</p>
</div>
<div class="sect4">
<h5 id="_rebuild"><a class="anchor" href="#_rebuild"></a>Rebuild</h5>
<div class="paragraph">
<p>A deployment can always launch and <strong>rebuild</strong> its state, representing aggregates, from scratch. Rebuilding will begin
this deployment at the very first event the input topic has received. You&#8217;d usually choose this option if you&#8217;re
making a correct to an existing service that had been deployed.</p>
</div>
</div>
<div class="sect4">
<h5 id="_resume"><a class="anchor" href="#_resume"></a>Resume</h5>
<div class="paragraph">
<p>The other option that can be chosen is to <strong>resume</strong> this deployment. Resuming will pick back up from the last
point where this deployment stopped processing. Pyroclast will only let you resume when it&#8217;s safe to do so.
This button will be disabled if you changed any property that would cause an aggregate to be computed in a different
way that would make it inconsistent with how it previously operated. This option is handy for avoiding recomputing
the entire stream of records in a topic when picking back up from the last record would work just as well.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_endpoints"><a class="anchor" href="#_endpoints"></a>Endpoints</h4>
<div class="paragraph">
<p>So far, we&#8217;ve covered how to make a topic to ingest events, how to design a service that will change those events
in some way, and how to launch that service. Endpoints are the means by which data is extracted from Pyroclast.
Each aggregation in a service will receive an endpoint, such that when a deployment for that service is launched,
invoking the endpoint will return the contents of the aggregate. This is similar to querying a database, except
that the results to this sort of query are continuously computed and constantly available. Each aggregate gets
its own endpoint, and endpoints are "stable" for a deployment. That means repeatedly deploying the production build
of a service with an aggregate will maintain the same endpoint information, and downstream consumers who invoke
that endpoint won&#8217;t need to change anything.</p>
</div>
</div>
<div class="sect3">
<h4 id="_exceptions"><a class="anchor" href="#_exceptions"></a>Exceptions</h4>
<div class="paragraph">
<p>Sometimes services will try to apply a function to an event in an incompatible way, and an exception will be thrown.
For example, you might choose the Plus function to add 50 the value in key "score" of the event. If the event doesn&#8217;t
have a value for that key, an exception will be thrown. Exceptions do not stop the deployment from proceeding. Each
exception (up to 100) will be logged on the right side of the deployment screen, denoting the type of exception, the event
that caused the exception, and it&#8217;s stacktrace. This information can be used to debug what went wrong, and you might modify
and rebuild your deployment in response.</p>
</div>
</div>
<div class="sect3">
<h4 id="_metrics_2"><a class="anchor" href="#_metrics_2"></a>Metrics</h4>
<div class="paragraph">
<p>Each running deployment maintains a set of metrics about how many events are being processed, and how latent they are.
Pyroclast exposes the amount of records being received in the input step per second, the amount of records either
being aggregated or output per second, and the 90th percentile of latency in milliseconds that it took each event
to fully makes its way through all the steps.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ingesting_events_into_pyroclast"><a class="anchor" href="#_ingesting_events_into_pyroclast"></a>Ingesting Events into Pyroclast</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Building an application on top of Pyroclast means that you&#8217;ll need to get your event data into our storage. Pyroclast
makes this easy with two techniques - HTTPS and Plumes. We&#8217;ll look at both of these.
In all both forms, data is "pushed" to Pyroclast. Event data is only sent to Pyroclast when you start services to send it.
This is different from "pull" based services that periodically analyze your data and replicate it into our storage. Pyroclast is a platform for building realtime applications, so we focus on processing your data quickly as you send it.</p>
</div>
<div class="sect2">
<h3 id="_https"><a class="anchor" href="#_https"></a>HTTPS</h3>
<div class="paragraph">
<p>The most direct way to send an event into Pyroclast is by using HTTPS. All methods of moving data into Pyroclast use HTTPS under the hood, so this is the most basic way to go about it. It&#8217;s preferable to use HTTP when we don&#8217;t offer a language binding for your programming language.</p>
</div>
<div class="paragraph">
<p>To send data over HTTPS, form your request to the following specification:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>method: POST</p>
</li>
<li>
<p>authentication: Basic Auth (username and password)</p>
</li>
<li>
<p>body: JSON event data, must be a map</p>
</li>
<li>
<p>headers: <code>Content-Type: application/json</code></p>
</li>
<li>
<p>endpoint: <code><a href="https://us-east-1.pyroclast.io/plume/_bulk?topic-id=&lt;topic-id&gt" class="bare">https://us-east-1.pyroclast.io/plume/_bulk?topic-id=&lt;topic-id&gt</a>;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the parameters to be filled in, view the page for your topic to find:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"Ingress Identifier": which is your topic ID to use in the endpoint</p>
</li>
<li>
<p>"Topic Owner": which is the username for Basic Auth</p>
</li>
<li>
<p>"Topic API Key": which is the password for Basic Auth</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The body must be a JSON map, which can be nested arbitrarily deep.</p>
</div>
</div>
<div class="sect2">
<h3 id="_plumes"><a class="anchor" href="#_plumes"></a>Plumes</h3>
<div class="paragraph">
<p>Plumes are a set of tools offered by Pyroclast to easily push us your event data. Plumes are useful for streaming lines out of a file system, rows out of a database, and metrics obtained by monitoring a service or operating system. Plumes are daemons that roll data up into events and send them out to Pyroclast on your behalf. Plumes intelligently checkpoint progress and retry in the event of failure, making them ideal for moving data in a non-invasive manner. There are two steps to using a Plume:</p>
</div>
<div class="paragraph">
<p>First, regardless of which Plume you&#8217;re using, download a Plume configuration from the topic page of which you wish to send data to. A single Yaml file will be downloaded, pre-filled with all the information needed for any Plume to send data securely to your topic.</p>
</div>
<div class="paragraph">
<p>Second, go to our open source <a href="https://github.com/onyx-platform/pyroclast-plumes">Plumes</a> repository and clone it locally. Build the Plume of your choice using the instructions in the README. Configure the Plume to your liking - for example, you might configure the File Plume to send events from a particular directory in your file system. Finally, run the Plume using the example command in the README, passing in the configuration file that you downloaded. Your events will automatically upload to Pyroclast.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_pyroclast_works"><a class="anchor" href="#_how_pyroclast_works"></a>How Pyroclast Works</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_high_level_summary"><a class="anchor" href="#_high_level_summary"></a>High Level Summary</h3>
<div class="paragraph">
<p>Pyroclast is a fully hosted cloud platform for building realtime data processing applications. In order to understand how Pyroclast works, we&#8217;ll discuss it from the two main user facing abstractions: topics and services - both how they work independently, and what their relationship is to each other.</p>
</div>
<div style="text-align: center">
<div class="imageblock">
<div class="content">
<img src="architecture/img/architecture.svg" alt="architecture" width="70%" height="70%">
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_topics_2"><a class="anchor" href="#_topics_2"></a>Topics</h3>
<div class="paragraph">
<p>When your system sends events to Pyroclast, those events are sent to a particular topic. A topic is a named log of events, typically representative of a feed or a category of information. An example of a topic might be "user events", actions that a user takes when they interact with your system. A topic would then consist of records, detailing actions such as a user visiting a page, or deleting an item from their shopping cart.</p>
</div>
<div class="sect3">
<h4 id="_topic_structure"><a class="anchor" href="#_topic_structure"></a>Topic Structure</h4>
<div class="paragraph">
<p>Topics are immutable and partitioned. A topic&#8217;s recoreds are immutable in that one a record has been written to the log for that topic, it cannot be modified or deleted. Each partition is partitioned several ways, meaning that its contents are partially ordered within each partition, but consumable in parallel across partitions.</p>
</div>
</div>
<div class="sect3">
<h4 id="_replication"><a class="anchor" href="#_replication"></a>Replication</h4>
<div class="paragraph">
<p>Each topic&#8217;s contents are replicated 3-ways when a record is ingested into Pyroclast. This means that if Pyroclast has a partial catastrophic failure, your data is recoverable without any intervention on your part.</p>
</div>
</div>
<div class="sect3">
<h4 id="_retention_2"><a class="anchor" href="#_retention_2"></a>Retention</h4>
<div class="paragraph">
<p>Events are retained in a topic for as long as you configure them to be. When a topic is created, retention policies are chosen. You can choose to retain events for a certain number of days and gigabytes. When a record exceeds that number of days, <strong>or</strong> the maximum amount of gigabytes have been exceeded, that record is removed from the topic. Records "slide off the front" - the oldest records are removed first, continually making room for new records.</p>
</div>
<div class="paragraph">
<p>This process is periodic, and you may temorarily have been data than you configured to retain.</p>
</div>
</div>
<div class="sect3">
<h4 id="_security"><a class="anchor" href="#_security"></a>Security</h4>
<div class="paragraph">
<p>Topic data at rested is stored in a location that is not public facing to the internet, and has strict ingress routes only accessible by services which read from its contents. Writing to a topic requires an API key on each request that is specific to each user. This API key can be rotated at any time.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_services_2"><a class="anchor" href="#_services_2"></a>Services</h3>
<div class="paragraph">
<p>While topics store events that are sent to Pyroclast, services are processes that read from topics and change those events into something usable for the rest of your architecture. We use the term "service" in the same way that it is conventionally used to describe a generic web service - a process with a set of accessible endpoints that perform work on command.</p>
</div>
<div class="paragraph">
<p>Continuing with the example, if you have a topic for user events, you might build a service that computes a rolling average of the number of times your users checked out their shopping cart each hour, or a service that does streaming-ETL work to modify the structure and contents of your events for further processing.</p>
</div>
<div class="sect3">
<h4 id="_attach_to_topics_for_ingest"><a class="anchor" href="#_attach_to_topics_for_ingest"></a>Attach to topics for ingest</h4>
<div class="paragraph">
<p>Services "attach" to a particular topic to consume their records and perform some work on them. When a service is deployed, it will ingest all records currently in the topic, as well as any new records that arrive in real time. While a service reads the records from a topic, it doesn&#8217;t remove or change them. Because of this property, multiple services can safely consume from the same topic, and will be guaranteed to see the same records without conflicting with one another.</p>
</div>
<div class="paragraph">
<p>As records are consumed, the service immediately applies a set of changes and aggregations to them. These changes are defined by the configuration of the particular service.</p>
</div>
</div>
<div class="sect3">
<h4 id="_backed_by_a_stream_processor"><a class="anchor" href="#_backed_by_a_stream_processor"></a>Backed by a stream processor</h4>
<div class="paragraph">
<p>Under the covers, each time a service is deployed, a stream processor is launched and paired with that service. Services can process extraordinarily large amounts of events at high speeds. A single web server wouldn&#8217;t be capable of computing this quickly. In the background, completely away from the point of view of a user, the stream processor begins to consume from the topic, applying changes and storing state in a location that is accessible for the service. When an endpoint for that service is called, the service turns around and accesses the underlying state produced by the stream processor. In this way, Pyroclast is able to invisibly offer streaming as a service.</p>
</div>
</div>
<div class="sect3">
<h4 id="_aggregations_as_queries"><a class="anchor" href="#_aggregations_as_queries"></a>Aggregations as queries</h4>
<div class="paragraph">
<p>When we say that the stream processor "stores state" for a service configuration, there are a few independent pieces of information that are durably stored. The main one from the users point of views are aggregation states.</p>
</div>
<div class="paragraph">
<p>In a regular SQL database, events can be pushed to a table, and queries can be launched that take the data in the table and return an aggregation - a smaller value that summarizes all the records that match the query&#8217;s criteria. The answer to the query is recomputed from scratch every time the query is issued, and the result is what we&#8217;ll call the aggregation state.</p>
</div>
<div class="paragraph">
<p>In Pyroclast, we do the exact inverse of the described operation. When data flows through your service, it is immediately factored into any aggregations that you&#8217;ve asked the service to perform. Using this approach, the aggregation <strong>is</strong> the query, and the answer to that query is incrementally updated every time a new piece of data arrives. This property yields constant time query access. That is, every time you issue a request to a service endpoint to access the value of an aggregation, you access the underlying aggregation state, which is updated in realtime. Thus, there is no more work to perform when you ask for the value of an aggregate - Pyroclast simply fetches the value and serves it up.</p>
</div>
<div class="paragraph">
<p>This holds true no matter how much data you push into Pyroclast. Very large topics will return in the same amount of time as very small ones (adjusting for the amount of time it takes to transfer the result data set from Pyroclast to your system).</p>
</div>
</div>
<div class="sect3">
<h4 id="_endpoints_as_query_endpoints"><a class="anchor" href="#_endpoints_as_query_endpoints"></a>Endpoints as query endpoints</h4>
<div class="paragraph">
<p>In the last section, we discussed how doing an analysis over event data could be done with a database, and what the drawbacks of what approach are. If we zoom in on how queries are issued under that model, (usually) SQL-esque queries are sent directly to a database server, which computes the results, and sends the answer back to your application. If the database server is down, your results are inaccessible.</p>
</div>
<div class="paragraph">
<p>With Pyroclast, aggregation state is accessed through the HTTP endpoints of your deployed service. Using this technique, we&#8217;re able to distance your application from the underlying storage that houses your aggregate state. Your application doesn&#8217;t need drivers to talk to a specific database or storage engine - all it needs to speak is HTTP, meaning any programming language can work with Pyroclast instantly.</p>
</div>
<div class="paragraph">
<p>Another important property is that the endpoints of each service deployment are <strong>stable</strong> - they don&#8217;t change, even if you take the service offline, reboot it, tweak it, and bring it online. This property is critical for integrating Pyroclast into your architecture. Producers and consumers of Pyroclast data can be configured with the endpoints and API token associated with your service once, and until you need to rotate your API token for any reason, these endpoints will always be valid.</p>
</div>
</div>
<div class="sect3">
<h4 id="_durable_replicated_materialized_views"><a class="anchor" href="#_durable_replicated_materialized_views"></a>Durable, replicated materialized views</h4>
<div class="paragraph">
<p>Another name for aggregation state is a <strong>materialized view</strong>. This term is more common in the database world, but is appropriate here because we durable maintain the answer to a query over time. In the previous sections, we discussed how the result of an aggregation, or query, is incrementally updated. The results to these queries are not only updated in real time - they are also durable stored on disk and replicated. In the event of an internal failure of stream processor that Pyroclast uses, your aggregation state is still accessible up to the point in time where it has last been computed. This applies even when you stop your service from running - the aggregation values are still accessible through the endpoints because they are replicated across data centers on disk.</p>
</div>
</div>
<div class="sect3">
<h4 id="_fault_tolerant_processing"><a class="anchor" href="#_fault_tolerant_processing"></a>Fault tolerant processing</h4>
<div class="paragraph">
<p>We have covered how aggregation state is maintained and durably replicated on disk. In the realm of fault tolerance, there are other angles to consider - specifically what happens to your service if the background stream processor has a problem and fails.</p>
</div>
<div class="paragraph">
<p>As the backing stream processor that pairs with your service consumes records from its input topic, it checkpoints its progress each time a record is fully processed. A record is fully processed if it successfully flows all the way through its sequence of tasks and terminates without unexpected problems. Pyroclast also durably stores and replicates its checkpoint data. If your service processes the first 200,000 records off its input topic, and your service and its stream processor are taken offline for some reason, the default action when the service relaunches it to <strong>resume</strong> from its last successful location in the topic. In this case, the stream processor would resume progress at the 200,001th record. <strong>Pyroclast guaruntees that none of your data will be be dropped or skipped.</strong></p>
</div>
</div>
<div class="sect3">
<h4 id="_scalable_high_performance_throughput"><a class="anchor" href="#_scalable_high_performance_throughput"></a>Scalable, high performance throughput</h4>
<div class="paragraph">
<p>The stream processor that pairs with each service is able to process incoming events at an extremely high volume - often on the order of hundreds of thousands of events per second for a service configured with 1x parallelism. By default, every service that you launch will have this grade of performance. If your service needs to be able to handle more data than that, it can be configured with more parallelism. A service configured with 5x parallelism will be able to handle 5x the throughput a service that isn&#8217;t scaled, assuming its input stream is fully saturated.</p>
</div>
<div class="paragraph">
<p>With the exception of some optimizations, most tasks within a service configuration will run on separate machines with dedicated threads. Messages are processed concurrently and in parallel across a distributed cluster of machines forming our stream processor fleet. Adding more parallelism to your service roughly corresponds to multiplying the number of threads and machines dedicated to performing work on your data.</p>
</div>
</div>
<div class="sect3">
<h4 id="_low_latency_processing"><a class="anchor" href="#_low_latency_processing"></a>Low latency processing</h4>
<div class="paragraph">
<p>In addition to being very high throughput, Pyroclast offers exceptionally low latency. When a record enters a topic that a service is consuming, it&#8217;s typically able to processor that message on the order of double digit milliseconds, assuming that the service is processing the most recent messages for the topic already. If the service in question is configured to resend each record to a new topic, it can typically do so subsecond, usually below 100 milliseconds. On the other hand, when a service reduces records into an aggregate, the aggregate&#8217;s value will be updated to reflect the new information roughly ever 2 seconds. This amount of time reflects the checkpointing period that was discussed earlier in this section. This value can be configured to be as low as 50 milliseconds if your applications performance concerns are demanding enough to require this.</p>
</div>
</div>
<div class="sect3">
<h4 id="_replaying_a_topic_s_events_from_scatch"><a class="anchor" href="#_replaying_a_topic_s_events_from_scatch"></a>Replaying a topic&#8217;s events from scatch</h4>
<div class="paragraph">
<p>The first time that a service is launched, it will begin consuming messages from the beginning of the topic its receiving input from. If a service is taken offline and relaunched, you have the option of either <strong>rebuilding</strong> or <strong>resuming</strong>. Resuming a service is the case where aggregation data is left in tact, and the checkpoints used to designate what spot in the input topic the service was reading from are resumed.</p>
</div>
<div class="paragraph">
<p>In contrast, sometimes you want <strong>rebuild</strong> the state in your service from scratch. Choosing this option causes your service to roll back and read from the beginning of your input topic once again, blowing away all previous state. This is highly useful if your service was configured incorrectly. Since topics are immutable, no information was lost. Your service can correct itself and begin serving up new aggregation values through its endpoints. Since the endpoints are stable, consumers of your service don&#8217;t need to do anything to receive the new, correct aggregation results.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pyroclast_api"><a class="anchor" href="#_pyroclast_api"></a>Pyroclast API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>HTTP API for deployed Pyroclast services.</p>
</div>
<div class="paragraph">
<p><strong>All API calls require basic authentication</strong></p>
</div>
<div class="literalblock">
<div class="content">
<pre>curl -u "[user id]:[api token]"</pre>
</div>
</div>
<div class="paragraph">
<p>All responses are formatted in <strong>JSON</strong>.</p>
</div>
<div class="sect2">
<h3 id="_get_svc_service_id"><a class="anchor" href="#_get_svc_service_id"></a>GET /svc/:service-id</h3>
<div class="paragraph">
<p>Returns information about all materialized views for this service.</p>
</div>
<div class="sect3">
<h4 id="_example_request"><a class="anchor" href="#_example_request"></a>example request</h4>
<div class="literalblock">
<div class="content">
<pre>$ curl -u "[user id]:[api key]" "https://us-east-1.pyroclast.io/svc/kzPgyNWQYJRVdr"</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_parameters"><a class="anchor" href="#_parameters"></a>parameters</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">in</th>
<th class="tableblock halign-left valign-top">required</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">service-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifier for this deployed service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">start</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclude all aggregates whose timestamp ending boundary falls before the specified time. This value is in milliseconds since the Unix epoch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">end</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclude all aggregates whose timestamp starting boundary falls after the specified time. This value is in milliseconds since the Unix epoch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When true, sorts aggregate results in ascending order according to the timestamp starting bound.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">datetime-format</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The format for datetime instances. (Options: <code>"iso-8601"</code>)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_response"><a class="anchor" href="#_response"></a>response</h4>
<div class="literalblock">
<div class="content">
<pre>{
    "trending-hashtags": {
        "contents": {
            "#yolo": [
                {
                    "bounds": [
                        1493856000000,
                        1493942399999
                    ],
                    "value": 259
                }
            ],
            "#pyroclast": [
                {
                    "bounds": [
                        1493856000000,
                        1493942399999
                    ],
                    "value": 121355146
                },
                {
                    "bounds": [
                        1493942400000,
                        1494028799999
                    ],
                    "value": 110717456
                }
            ]
        },
        "grouped?": true,
        "id": "a21715fb-4662-4a41-9740-950d5c84b65b",
        "type": "fixed"
    }
}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_get_svc_service_id_aggregate"><a class="anchor" href="#_get_svc_service_id_aggregate"></a>GET /svc/:service-id/:aggregate</h3>
<div class="paragraph">
<p>Gets a specific aggregate by name from this service.</p>
</div>
<div class="sect3">
<h4 id="_example_request_2"><a class="anchor" href="#_example_request_2"></a>example request</h4>
<div class="literalblock">
<div class="content">
<pre>$ curl -u "[user id]:[api key]" "https://us-east-1.pyroclast.io/svc/kzPgyNWQYJRVdr/trending-hashtags"</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_parameters_2"><a class="anchor" href="#_parameters_2"></a>parameters</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">in</th>
<th class="tableblock halign-left valign-top">required</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">service-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifier for this deployed service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">start</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclude all aggregates whose timestamp ending boundary falls before the specified time. This value is in milliseconds since the Unix epoch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">end</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclude all aggregates whose timestamp starting boundary falls after the specified time. This value is in milliseconds since the Unix epoch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When true, sorts aggregate results in ascending order according to the timestamp starting bound.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">datetime-format</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The format for datetime instances. (Options: <code>"iso-8601"</code>)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_response_2"><a class="anchor" href="#_response_2"></a>response</h4>
<div class="literalblock">
<div class="content">
<pre>{
    "contents": {
        "#yolo": [
            {
                "bounds": [
                    1493856000000,
                    1493942399999
                ],
                "value": 259
            }
        ],
        "#pyroclast": [
            {
                "bounds": [
                    1493856000000,
                    1493942399999
                ],
                "value": 121355146
            },
            {
                "bounds": [
                    1493942400000,
                    1494028799999
                ],
                "value": 110717456
            }
        ]
    },
    "grouped?": true,
    "id": "a21715fb-4662-4a41-9740-950d5c84b65b",
    "type": "fixed"
}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_get_svc_aggregate_group"><a class="anchor" href="#_get_svc_aggregate_group"></a>GET /svc/:aggregate/:group</h3>
<div class="paragraph">
<p>Gets a specific aggregate by name from this service.</p>
</div>
<div class="sect3">
<h4 id="_example_request_3"><a class="anchor" href="#_example_request_3"></a>example request</h4>
<div class="literalblock">
<div class="content">
<pre>$ curl -u "[user id]:[api key]" "https://us-east-1.pyroclast.io/svc/kzPgyNWQYJRVdr/trending-hashtags/yolo"</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_parameters_3"><a class="anchor" href="#_parameters_3"></a>parameters</h4>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">name</th>
<th class="tableblock halign-left valign-top">in</th>
<th class="tableblock halign-left valign-top">required</th>
<th class="tableblock halign-left valign-top">type</th>
<th class="tableblock halign-left valign-top">description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">service-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identifier for this deployed service.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">start</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclude all aggregates whose timestamp ending boundary falls before the specified time. This value is in milliseconds since the Unix epoch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">end</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclude all aggregates whose timestamp starting boundary falls after the specified time. This value is in milliseconds since the Unix epoch.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When true, sorts aggregate results in ascending order according to the timestamp starting bound.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">datetime-format</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">query</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The format for datetime instances. (Options: <code>"iso-8601"</code>)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_response_3"><a class="anchor" href="#_response_3"></a>response</h4>
<div class="literalblock">
<div class="content">
<pre>{
    "contents": [
        {
            "bounds": [
                1493856000000,
                1493942399999
            ],
            "value": 259
        }
    ],
    "grouped?": true,
    "id": "a21715fb-4662-4a41-9740-950d5c84b65b",
    "type": "fixed"
}</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_usage_patterns"><a class="anchor" href="#_usage_patterns"></a>Usage Patterns</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_parsing_value_types"><a class="anchor" href="#_parsing_value_types"></a>Parsing value types</h3>
<div class="paragraph">
<p><strong>Problem:</strong> you have records whose values are of a different type than you want.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> Suppose you have the following record:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">first-name</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">steven</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">45</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Perhaps you&#8217;d like to make an aggegate over all your events to find the average age.
Notably, age isn&#8217;t an integer in this record - it&#8217;s a string. We need to turn it
into a number before we can apply an average.</p>
</div>
<div class="paragraph">
<p><strong>Solution:</strong> use the <code>parse-vals</code> transformation.</p>
</div>
<div class="paragraph">
<p><code>parse-vals</code> takes a map of key names to string type values. The keys are
the keys in the record to parse, and the values are the target types to to.</p>
</div>
<div class="paragraph">
<p>In this case, we specify a parse map to turn the "age" key into an "integer".
Notably, you only need to specify the desired type, and not the type to convert
from.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-1.png" alt="img 1">
</div>
</div>
</details>
<div class="sect3">
<h4 id="_parsing_multiple_values"><a class="anchor" href="#_parsing_multiple_values"></a>Parsing multiple values</h4>
<div class="paragraph">
<p><code>parse-vals</code> is capable of parsing many keys in a single invocation. Simply
add more key/value pairs to the parse map. In the next example, we parse
both an age to an integer, and a boolean flag denoting whether or not this
user is from a legancy system.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-2.png" alt="img 2">
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_unparseable_values"><a class="anchor" href="#_unparseable_values"></a>Unparseable values</h4>
<div class="paragraph">
<p>When a value can&#8217;t be parsed to its target type, an exception is thrown.
The record will not proceed to the next task, and the exception will be
listed in the deployment screen. The string <code>"banana"</code> can&#8217;t be parsed
to an integer, so an exception is thrown.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-3.png" alt="img 3">
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_handling_null_values"><a class="anchor" href="#_handling_null_values"></a>Handling null values</h4>
<div class="paragraph">
<p>Null values will throw an exception when they&#8217;re attempted to be parsed.
If you&#8217;re excepting some of your values to be null and that&#8217;s okay for your
application, tick the "Allow Nulls?" box underneath the Parse Map text box.
This has the effect of not attempting to parse the value, passing it through
unmodified.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-4.png" alt="img 4">
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_limitations"><a class="anchor" href="#_limitations"></a>Limitations</h4>
<div class="paragraph">
<p>At this time, parse-vals only worked on top-level keys. If you need to parse a nested
value, move it to the top of the map using the <code>move</code> function. This will be addressed
in the future.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_selecting_relevant_events"><a class="anchor" href="#_selecting_relevant_events"></a>Selecting relevant events</h3>
<div class="paragraph">
<p><strong>Problem:</strong> you have records in your topic with varying attributes, and you only
want to process records that match particular criteria.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> Suppose you have the following records:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">jim</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">action</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">view-page</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">page</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/timeline</span><span class="delimiter">&quot;</span></span>
}

{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">sue</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">action</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">favorite-item</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">item-id</span><span class="delimiter">&quot;</span></span>: <span class="integer">329572385</span>
}

{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">cindy</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">action</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">update-status</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Going home now.</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You&#8217;re making a service that&#8217;s only interested in status update events. Your topic has
events of all types from different users, but you only need to look at events whose
<code>"action"</code> key maps to the <code>"update-status"</code> value, effectively removing all other
event types from the stream.</p>
</div>
<div class="paragraph">
<p><strong>Solution:</strong> use a filter with the <code>=</code> predicate.</p>
</div>
<div class="paragraph">
<p>A filter only allows events to pass through that match the criteria of a particular
predicate. If our criteria is to only allow through event actions matching <code>"update-status"</code>,
we can use the <code>=</code> predicate to check equality.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-1.png" alt="img 1" height="60%; width=60%;">
</div>
</div>
</details>
<div class="sect3">
<h4 id="_removing_matching_events"><a class="anchor" href="#_removing_matching_events"></a>Removing matching events</h4>
<div class="paragraph">
<p>Sometimes you&#8217;d prefer to do perform the inverse action to filtering - removing events
that match your criteria. Let&#8217;s suppose instead that you want to process all events
that <strong>are not</strong> a status update. You can either use the <code>not=</code> predicate, or continue
to use the <code>=</code> predicate and tick the Negate? checkbox.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-2.png" alt="img 2" height="60%; width=60%;">
</div>
</div>
</details>
</div>
</div>
<div class="sect2">
<h3 id="_diangosing_unconforming_data"><a class="anchor" href="#_diangosing_unconforming_data"></a>Diangosing unconforming data</h3>
<div class="paragraph">
<p><strong>Problem:</strong> you have records in your topic that may not all conform to the your expected
schema, and you want to find them.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> Suppose you have the following records:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">bob</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>: <span class="integer">28</span>
}

{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">alice</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">age</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">thirty-two</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If your service expects all ages to be integers, an exception will be thrown at some
point if you try to perform a numeric operation on the event for Alice, since age
is a string with a number spelled out in English. We want to find all the events with
a non-integer age.</p>
</div>
<div class="paragraph">
<p><strong>Solution:</strong> use a filter with the <code>integer?</code> and throw exceptions on unmatched events.</p>
</div>
<div class="paragraph">
<p>Filters have a checkbox option to "Throw exception on unmatch?". When an event fails
to meet the criteria for a predicate, it is normally silently discarded from flowing
further down to subsequent tasks. In this case, we&#8217;re interested in finding events that
don&#8217;t conform to our expectations that age is an integer, and we want to know which
records these are so that we can perform further diagnosis about where they came from
and why. If we check the box to throw on unmatch, records that don&#8217;t meet the criteria
throw an exception at runtime, and the record&#8217;s value will be visible inside the Exception
information box in a deployment.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-1.png" alt="img 1" height="60%; width=60%;">
</div>
</div>
</details>
<div class="sect3">
<h4 id="_negated_filters_with_unmatched_exceptions"><a class="anchor" href="#_negated_filters_with_unmatched_exceptions"></a>Negated filters with unmatched exceptions</h4>
<div class="paragraph">
<p>In the above scenario, we selected the option to throw an exception when a record does
not meet the criteria of the record - for example, <code>"age"</code> is an integer.</p>
</div>
<div class="paragraph">
<p>We can do the inverse as well. By selecting the Negate? checkbox, Pyroclast will throw
exceptions for all events that pass the specified predicate. For example, to throw
exceptions on all values that have an empty string, we could use the <code>empty?</code> predicate,
negated, and throw on unmatched. With this, the value <code>"visit-page"</code> will continue to flow
downstream, but the empty string, <code>""</code>, will throw a runtime exception.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-2.png" alt="img 2" height="60%; width=60%;">
</div>
</div>
</details>
</div>
</div>
<div class="sect2">
<h3 id="_changing_event_structure"><a class="anchor" href="#_changing_event_structure"></a>Changing Event Structure</h3>
<div class="paragraph">
<p><strong>Problem:</strong> your records are in a structure that is different from what you want.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> Suppose you have the following record:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">favorites</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">color</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">red</span><span class="delimiter">&quot;</span></span>
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s say you&#8217;d like to restructure the event so that <code>"favorite-color"</code> is moved
from being a nested key into a top level key.</p>
</div>
<div class="paragraph">
<p><strong>Solution:</strong> use the <code>move</code> transformation.</p>
</div>
<div class="paragraph">
<p><code>move</code> takes a source sequence of keys to a target value and a destination
sequence of keys to denote where the value should be moved to. A "key sequence"
is an array of keys to progressively "get" from the map or array, after which
the value is taken.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-1.png" alt="img 1">
</div>
</div>
</details>
<div class="sect3">
<h4 id="_moving_a_value_in_an_array"><a class="anchor" href="#_moving_a_value_in_an_array"></a>Moving a value in an array</h4>
<div class="paragraph">
<p><code>move</code> can lift values out of arrays by specifying its index as the "key"
in the key sequence. In this example, we have an array of number of hits
in a 6-inning baseball game. If we&#8217;re interested in lifting the number of
hits in the 3rd inning to a top level key, we can get a handle on it with
<code>["hits", 2]</code>, where 2 is the zero-based index of the <code>"hits"</code> array.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-2.png" alt="img 2">
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_moving_a_submap_to_the_top"><a class="anchor" href="#_moving_a_submap_to_the_top"></a>Moving a submap to the top</h4>
<div class="paragraph">
<p><code>move</code> can also lift a submap to the top level of a record using <code>[]</code> as the
destination key sequence. Notable, this "splats" the submap to the parent map,
remove the submap entirely. In this example, we move all the keys under
<code>"person"</code> and make them top level keys in the record.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-3.png" alt="img 3">
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_nesting_values_further"><a class="anchor" href="#_nesting_values_further"></a>Nesting values further</h4>
<div class="paragraph">
<p>Instead of moving a value from a nested position in a map into a higher level,
we can also push it further down. In this example, we take a generic top level
key and put it in a more specific key structure.</p>
</div>
<div class="paragraph">
<p>Keys in submaps will be automatically created. Array indexes are valid in the last
position, so long as the target array exists. Arrays will <strong>not</strong> be automatically
created.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-4.png" alt="img 4">
</div>
</div>
</details>
</div>
</div>
<div class="sect2">
<h3 id="_splitting_a_single_record_into_many_records"><a class="anchor" href="#_splitting_a_single_record_into_many_records"></a>Splitting a single record into many records</h3>
<div class="paragraph">
<p><strong>Problem:</strong> your record has a piece of data that is representative of many records,
and you want to split it apart.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> Suppose you have the following record:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">activity-batch</span><span class="delimiter">&quot;</span></span>: [
    {<span class="key"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">stu</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">action</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">retweet</span><span class="delimiter">&quot;</span></span>},
    {<span class="key"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">lisa</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">action</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">favorite</span><span class="delimiter">&quot;</span></span>},
    {<span class="key"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ron</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">action</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">tweet</span><span class="delimiter">&quot;</span></span>}
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This record contains a batch of information - three distinct actions for users.
Pyroclast can process this record by itself, but you might want to split it apart
into 3 independent records.</p>
</div>
<div class="paragraph">
<p><strong>Solution:</strong> use the <code>explode</code> transformation.</p>
</div>
<div class="paragraph">
<p><code>explode</code> is a function that takes an array value and extracts its subelements into
their own records. In this example, <code>"activity-batch"</code> is transformed from a single
array into output with <strong>3</strong> distinct records (denoted by the array around the output).
Each of these records will now flow independently to the subsequent steps.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-1.png" alt="img 1">
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="_parsing_regular_expressions_into_named_values"><a class="anchor" href="#_parsing_regular_expressions_into_named_values"></a>Parsing regular expressions into named values</h3>
<div class="paragraph">
<p><strong>Problem:</strong> you want to apply a regular expression to a string and name each of the group matches.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> Suppose you have the following record:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">date</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Jan-13-1991</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we apply a regular expression to capture the month, day, and year in the <code>"date"</code>
key, we want to be able to name each of these values for independent use.</p>
</div>
<div class="paragraph">
<p><strong>Solution:</strong> use the <code>extract-regex-match</code> and <code>zipmap</code> transformations.</p>
</div>
<div class="paragraph">
<p>A clean solution is to use two functions together. First, <code>extract-regex-match</code> does
the obvious heavy lifting in applying a regular expression to a string. This function
returns an array of matches, with the first element being the target string itself as
is standard.</p>
</div>
<div class="paragraph">
<p>Next, apply the <code>zipmap</code> function, which takes an array of values, and a sequence of keys
to "zip" against it. In this example, we zip the array of parsed values with a key sequence
denoting the name of each value to achieve a map of named matches.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-1.png" alt="img 1">
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="_assigning_default_values"><a class="anchor" href="#_assigning_default_values"></a>Assigning default values</h3>
<div class="paragraph">
<p><strong>Problem:</strong> a key in your record might not have a value, and you want to default it if it doesn&#8217;t.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> Suppose you have the following records:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">john</span><span class="delimiter">&quot;</span></span>,
  <span class="key"><span class="delimiter">&quot;</span><span class="content">premium?</span><span class="delimiter">&quot;</span></span>: <span class="value">true</span>
}

{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>: <span class="key"><span class="delimiter">&quot;</span><span class="content">sally</span><span class="delimiter">&quot;</span></span>:
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Only the first record has a flag for <code>"premium?"</code>. Suppose we want all records to conform
to the same schema, and for some records, we&#8217;re going to need to provide a default value
if there isn&#8217;t one present already.</p>
</div>
<div class="paragraph">
<p><strong>Solution:</strong> use the <code>assoc-default</code> transformation.</p>
</div>
<div class="paragraph">
<p><code>assoc-default</code> takes a key and a value. If the value for that key is null (e.g. it&#8217;s not present),
the provided value will be associated with the key.  If a value already exists, it is not modified.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-1.png" alt="img 1">
</div>
</div>
</details>
</div>
<div class="sect2">
<h3 id="_coercing_datetime_values"><a class="anchor" href="#_coercing_datetime_values"></a>Coercing datetime values</h3>
<div class="paragraph">
<p><strong>Problem:</strong> you have a datetime representation that is that needs to be formatted differently.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> Suppose you have the following record:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">event-time</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Thu May 11 2017 14:47:42</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Suppose we want to turn this formatted timestamp into milliseconds since the Unix epoch.</p>
</div>
<div class="paragraph">
<p><strong>Solution:</strong> use the <code>parse-datetime</code> transformation.</p>
</div>
<div class="paragraph">
<p><code>parse-datetime</code> takes a target key with the formatted value, and a format string to try
and parse the value with. The format specification follows the JodaTime project. When
a value is successfully parsed, it is turned into milliseconds since the Unix epoch.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-1.png" alt="img 1">
</div>
</div>
</details>
<div class="sect3">
<h4 id="_parsing_exceptions"><a class="anchor" href="#_parsing_exceptions"></a>Parsing Exceptions</h4>
<div class="paragraph">
<p>When a datetime can&#8217;t be parsed, an exception is thrown, and the record is not passed
to subsequent tasks.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-2.png" alt="img 2">
</div>
</div>
</details>
</div>
<div class="sect3">
<h4 id="_unparsing_unix_epoch_values"><a class="anchor" href="#_unparsing_unix_epoch_values"></a>Unparsing Unix epoch values</h4>
<div class="paragraph">
<p>Sometimes you want to go in the other direction: turning a timestamp value that
is in milliseconds since the Unix epoch to a formatted value. We use the
<code>format-unix-ms-timestamp</code> function to handle this. <code>format-unix-ms-timestamp</code>
takes a key which has an epoch value, and a format to transform the value into.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-3.png" alt="img 3">
</div>
</div>
</details>
</div>
</div>
<div class="sect2">
<h3 id="_accessing_nested_values"><a class="anchor" href="#_accessing_nested_values"></a>Accessing nested values</h3>
<div class="paragraph">
<p><strong>Problem:</strong> you want to retrieve or set a value nested inside a record.</p>
</div>
<div class="paragraph">
<p><strong>Example:</strong> Suppose you have the following record:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">team</span><span class="delimiter">&quot;</span></span>: [
    {<span class="key"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">bob</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">points</span><span class="delimiter">&quot;</span></span>: <span class="integer">51</span>},
    {<span class="key"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">malinda</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">points</span><span class="delimiter">&quot;</span></span>: <span class="integer">98</span>},
    {<span class="key"><span class="delimiter">&quot;</span><span class="content">user</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">ron</span><span class="delimiter">&quot;</span></span>, <span class="key"><span class="delimiter">&quot;</span><span class="content">points</span><span class="delimiter">&quot;</span></span>: <span class="integer">640</span>}
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Further, suppose you want to double the number of points for the first user in every team.
This would involve using the <code>times</code> function, but we need a way to express
that the target key is nested.</p>
</div>
<div class="paragraph">
<p><strong>Solution:</strong> use a key sequence.</p>
</div>
<div class="paragraph">
<p>A key sequence is an array of keys to progressively "get"
from the map or array, after which the value is taken. To get the first user&#8217;s points
in the team, the key path is <code>["team", 0, "points"]</code>. <code>"team"</code> is the key, which yields
an array of users. <code>0</code> is the "key", in this case an index into the array, which yields
another map - the user map. The final key is <code>"points"</code>, which accesses a non-collection
value.</p>
</div>
<div class="paragraph">
<p>Almost all functions in Pyroclast accept key sequences for the source and target keys, allowing
you to move values up and down a records' hierarchy arbitrarily.</p>
</div>
<details>
  <summary><strong>Image</strong></summary>
  <br/>
<div class="imageblock">
<div class="content">
<img src="learn-pyroclast/img/parsing-value-types/img-1.png" alt="img 1">
</div>
</div>
</details>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-05-12 10:47:04 PDT
</div>
</div>
</body>
</html>